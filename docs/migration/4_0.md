# Technical Changes in Spartacus 4.0

## Breaking Changes Introduced in 4.0

### Feature keys for product configurators

The feature keys that are used to lazily load the product configurator libraries in app.module.ts were available as `rulebased` and `productConfiguratorRulebased` from 3.1 onwards (respective `textfield` and `productConfiguratorTextfield` for the textfield template configurator).

In 4.0, only the longer versions `productConfiguratorRulebased` and `productConfiguratorTextfield` are possible.

Example: A configuration

```
      featureModules: {
        rulebased: {
          module: () => import('@spartacus/product-configurator/rulebased').then(
          (m) => m.RulebasedConfiguratorModule
        ),
        },
      }
```

needs to look like that in 4.0

```
      featureModules: {
        productConfiguratorRulebased: {
          module: () => import('@spartacus/product-configurator/rulebased').then(
          (m) => m.RulebasedConfiguratorModule
        ),
        },
      }
```

### Translations (i18n) changed

- Key `asm.standardSessionInProgress` was removed.

## Storage Sync mechanism

I version 4.0 we removed deprecated in version 3.0 storage sync mechanism. In previous major release we provided more powerful mechanism based on `StatePersistenceService` which can cover all use cases for synchronizing data to and from browser storage (eg. `localStorage`, `sessionStorage`) better than the removed storage sync.

What was removed:

- core of the mechanism (reducer)
- configuration (`storageSync` from `StateConfig`)
- default config and default keys (`defaultStateConfig`, `DEFAULT_LOCAL_STORAGE_KEY` and `DEFAULT_SESSION_STORAGE_KEY`)

`ConfiguratorAttributeCheckboxListComponent` now also requires `ConfiguratorAttributeQuantityService`.
`ConfiguratorAttributeDropDownComponent` now also requires `ConfiguratorAttributeQuantityService`.
`ConfiguratorAttributeRadiButtonComponent` now also requires `ConfiguratorAttributeQuantityService`.
`ConfiguratorCartEntryInfoComponent` now also requires `CommonConfiguratorUtilsService`.
`ConfiguratorStorefrontUtilsService` now also requires `WindowRef` and `KeyboardFocusService`.
`ConfiguratorFormComponent` now also requires `ConfiguratorStorefrontUtilsService`. 

### ConfiguratorAttributeDropDownComponent

Method `onSelect` has been removed, it is no longer used. Use `onSelect` from super class which takes the value as argument

### ConfiguratorAttributeNumericInputFieldComponent

Method `createEventFromInput` has been removed, it is no longer used

### ConfiguratorAttributeRadioButtonComponent

Method `onDeselect` has been removed, it is no longer used

### ConfiguratorProductTitleComponent

Methods `getProductImageURL`, `getProductImageAlt` and `clickOnEnter` have been removed, there are no longer used

### ConfiguratorGroupMenuComponent

Methods `clickOnEnter` and `navigateUpOnEnter` have been removed, there are no longer used

